# Data Generation Scripts

This directory contains Python scripts to generate CSV data that will be used as seeds in the dbt project.

## üöÄ Main Script

### `generate_all_data.py`
Main script that executes all other scripts in sequence:
```bash
python scripts/generate_all_data.py
```

**Advantages:**
- Executes all scripts automatically
- Pre-defined configurations to generate data with problems
- Detailed execution report
- Generates ideal data to test the `problematic_orders` model

## üìä Individual Scripts

### `generate_customer_data.py`
Generates customer data with quality problems:
```bash
python scripts/generate_customer_data.py -n 1000
```

**Problems included:**
- 25% of emails are invalid (no @ symbol, no domain, empty, etc.)
- 30% of phones are invalid (too short, too long, with letters, etc.)
- 5% of customers have no phone

### `generate_products_data.py`
Generates product data with price problems:
```bash
python scripts/generate_products_data.py -n 500
```

**Problems included:**
- 15% of products have price problems (negative, zero, very high, missing)

### `generate_items_data.py`
Generates items and orders data with data problems:
```bash
python scripts/generate_items_data.py -n 2000 -o 1000
```

**Problems included:**
- 10% of orders have data problems:
  - `negative_amount`: Negative values (-1000 to -1)
  - `zero_amount`: Zero values
  - `missing_date`: Missing date
  - `missing_status`: Missing status
  - `suspiciously_high`: Very high values (10,001 to 50,000)
  - `future_date`: Future dates (1 to 30 days in the future)

## ‚öôÔ∏è Configuration

### `config.py`
Centralized configuration file that contains:
- **File paths**: All output file locations
- **Default values**: Default quantities for data generation
- **Problem percentages**: Configurable percentages for data quality issues
- **Value ranges**: Ranges for problematic values
- **Geographic data**: Brazilian states and cities
- **Product categories**: Product categories and examples
- **Order data**: Statuses and payment methods
- **Invalid data examples**: Specific examples of invalid data for testing

**Benefits of centralized configuration:**
- Single source of truth for all paths and settings
- Easy to modify output locations
- Consistent configuration across all scripts
- Prevents saving data to wrong locations
- All problem types and examples are centralized

**How configuration is used:**
- **File paths**: All scripts use constants like `CUSTOMERS_FILE`, `PRODUCTS_FILE`, etc.
- **Problem types**: Scripts select from `ORDER_PROBLEM_TYPES`, `PRODUCT_PROBLEM_TYPES`, etc.
- **Invalid data examples**: Scripts use `INVALID_DATA_EXAMPLES` to generate specific problem cases
- **Value ranges**: Scripts use `VALUE_RANGES` for consistent problematic values
- **Percentages**: Scripts use `PROBLEM_PERCENTAGES` for consistent problem distribution

## üéØ How to Use

### 1. Complete Generation (Recommended)
```bash
cd jaffle_shop
python scripts/generate_all_data.py
```

### 2. Individual Generation
```bash
# Generate only customers
python scripts/generate_customer_data.py -n 1000

# Generate only products
python scripts/generate_products_data.py -n 500

# Generate orders and items
python scripts/generate_items_data.py -n 2000 -o 1000
```

## üîç Generated Data

The scripts generate CSV files in the `seeds/jaffle-data/` folder:

- `raw_customers.csv` - Customers with email/phone problems
- `raw_products.csv` - Products with price problems  
- `raw_orders.csv` - Orders with data problems
- `raw_items.csv` - Order items

## üß™ Testing problematic_orders

After generating data, execute the `problematic_orders` model:

```bash
dbt run --select problematic_orders
```

This model should identify all data problems generated by the scripts, including:

- **Order problems**: negative values, future dates, missing status
- **Customer problems**: invalid emails and phones
- **Product problems**: invalid prices

## üìã Requirements

- Python 3.7+
- Faker (`pip install Faker`)
- Access to `seeds/jaffle-data/` directory

## ‚ö†Ô∏è Important Notes

- Scripts overwrite existing CSV files
- Data is fictitious and randomly generated
- Problem proportions may vary between executions
- Always run `dbt seed` after generating new data
- All file paths are centralized in `config.py`

## üîß Customization

To modify output locations or problem percentages:

1. Edit `scripts/config.py`
2. Modify the constants as needed
3. Run the scripts again

**Example of customization:**
```python
# In config.py
PROBLEM_PERCENTAGES = {
    'orders': {
        'data_problems': 0.20  # Increase to 20% of orders with problems
    }
}
```
